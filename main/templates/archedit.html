<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Edit-{{.Profile.Name}}</title>

    <script src="/assets/vendor/jquery-1.10.2/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/assets/vendor/bootstrap-4.3.1/bootstrap.min.css">

    <link rel="stylesheet" type="text/css" href="/assets/css/archedit.css">
</head>

<body>
<div class="overall">
    <div class="leftbar">
        <div class="tools">
            Click to add and drag. Right-click to remove.
            <hr />
            <button onclick="addItemImage(this, '008-table')">
                <img src="/assets/icons/lineral/008-table.svg" alt="Table.svg"> Add Table </img>
            </button>
            <button onclick="addItemImage(this, '014-toilet')">
                <img src="/assets/icons/lineral/014-toilet.svg" alt="Toilet.svg"> Add Toilet </img>
            </button>
            <button onclick="addItemImage(this, '011-tv-table')">
                <img src="/assets/icons/lineral/011-tv-table.svg" alt="TV.svg"> Add TV </img>
            </button>
            <button onclick="addItemImage(this, '001-sofa')">
                <img src="/assets/icons/lineral/001-sofa.svg" alt="Sofa.svg"> Add Sofa </img>
            </button>
            <button onclick="addItemImage(this, '025-bed')">
                <img src="/assets/icons/lineral/025-bed.svg" alt="Bed.svg"> Add Bed </img>
            </button>
        </div>

        <div class="textures"></div>
    </div>

    <div class="designBoard">
        <ul>
            <li class="bath">Bathroom</li>
            <li class="bed">Bedroom</li>
            <li class="live">Living Room</li>
            <li class="kitchen">Kitchen</li>
            <div class="gear">
                <div class="center"></div>
                <div class="tooth"></div>
                <div class="tooth"></div>
                <div class="tooth"></div>
                <div class="tooth"></div>
            </div>
        </ul>
        <div id = "bath" class = "tab"></div>
        <div id = "bed" class = "tab"></div>
        <div id = "live" class = "tab"></div>
        <div id = "kitchen" class = "tab"></div>
    </div>

    <div class="chatbox">
        Client Info:
        {{.Profile.Name}}
        {{printf "%.2f" .Profile.Budget}}
        {{.Profile.Area}}
        {{.Profile.Location}}
        <hr />
        {{.CurrentProject.TextSoFar}}
    </div>
</div>
</body>

<script>
  var currentDiv = "bath";
  $(".bath").css( "background-color", "#4CAF50");
  $(".designBoard>.tab").css("visibility","hidden");
  $("#bath").css("visibility","visible");
  $("ul>li").click(function() {
      $("ul>li").css( "background-color", "#333");
      $(this).css( "background-color", "#4CAF50");
      console.log(this.className);
      $(".designBoard>.tab").css("visibility","hidden");
      $("#"+ this.className).css("visibility","visible");
      currentDiv = this.className;
  });

  // In case we want "undo" and "redo."
  //item_properties = []

  // Create elements in div designBoard
  function addItemImage(elem, itemName) {
    var img = new Image(250,250);
    img.style.position = "absolute";
    img.src = "/assets/icons/lineral/" + itemName + ".svg";
    // Right-click to remove itself
    img.oncontextmenu = function(e) { 
        e.preventDefault();
        this.parentNode.removeChild(this) 
    }
    document.getElementById(currentDiv).appendChild(img);
    makeDraggable(img);
  }

  // Largely borrowed from w3schools.com/howto/howto_js_draggable.asp
  function makeDraggable(elmnt) {
    var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
    elmnt.onmousedown = dragMouseDown;
    elmnt.onpointerdown = dragMouseDown;
    function dragMouseDown(e) {
        e = e || window.event;
        e.preventDefault();
        // get the mouse cursor position at startup:
        pos3 = e.clientX;
        pos4 = e.clientY;
        document.onmouseup = closeDragElement;
        document.onpointerup = closeDragElement;
        // call a function whenever the cursor moves:
        document.onmousemove = elementDrag;
        document.onpointermove = elementDrag;
    }
    function elementDrag(e) {
        e = e || window.event;
        e.preventDefault();
        // calculate the new cursor position:
        pos1 = pos3 - e.clientX;
        pos2 = pos4 - e.clientY;
        pos3 = e.clientX;
        pos4 = e.clientY;
        // Gary: set the element's new position:
        //console.log(bounds(elmnt.offsetTop - pos2, 0, bounds(document.getElementById(currentDiv).clientHeight)));
        elmnt.style.top = bounds(elmnt.offsetTop - pos2, 0, bounds(document.getElementById(currentDiv).clientHeight)- elmnt.clientHeight) + "px";
        elmnt.style.left = bounds(elmnt.offsetLeft - pos1, 0, bounds(document.getElementById(currentDiv).clientWidth)- elmnt.clientWidth) + "px";
    }
    function bounds (number, lowerlimit, upperlimit) {
        if (number > upperlimit) {
            return upperlimit;
        } else if (number < lowerlimit) {
            return lowerlimit;
        } else {
            return number;
        }
    }
    function closeDragElement() {
        /* stop moving when mouse button is released:*/
        document.onmouseup = null;
        document.onpointerend = null;
        document.onmousemove = null;
        document.onpointermove = null;
    }
  }

  function randomColor() {
    var letters = '0123456789ABCDEF';
    var color = '#';
    for (var i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * 16)];
    }
    return color;
  }
</script>

</html>
